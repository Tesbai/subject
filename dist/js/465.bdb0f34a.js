"use strict";(self["webpackChunk_10_18"]=self["webpackChunk_10_18"]||[]).push([[465],{37465:function(t,e,a){a.r(e),a.d(e,{default:function(){return Z}});var i=function(){var t=this,e=t._self._c;return e("div",[t.add_state?e("Add",{attrs:{chapter_id:t.chapter_id},on:{add_video:t.add_video,upload:t.upload}}):t._e(),e("el-button",{on:{click:t.add_video}},[t._v("新增视频")]),e("div",{staticClass:"find_video"},[e("el-select",{attrs:{placeholder:t.value_subject},on:{change:t.change},model:{value:t.value_subject,callback:function(e){t.value_subject=e},expression:"value_subject"}},t._l(t.subject,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.name}})})),1),e("el-select",{attrs:{placeholder:t.value_chapter},on:{change:t.change_chapter},model:{value:t.value_chapter,callback:function(e){t.value_chapter=e},expression:"value_chapter"}},t._l(t.chapter,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.name}})})),1)],1),t.cont_state?e("Bullet"):t._e(),t._l(t.video_src,(function(a,i){return e("div",{key:a.id,staticClass:"video"},[e("video",{attrs:{src:a,controls:"",muted:"",height:"300px",width:"70%"},domProps:{muted:!0}}),e("div",{staticClass:"btn"},[e("el-button",{on:{click:function(e){return t.upload_video(i)}}},[t._v("更新")]),e("el-button",{on:{click:function(e){return t.delete_video(i)}}},[t._v("删除")])],1)])}))],2)},n=[],s=(a(57658),function(){var t=this,e=t._self._c;return e("h1",[t._v("请添加内容")])}),r=[],o={},d=o,c=a(1001),l=(0,c.Z)(d,s,r,!1,null,null,null),u=l.exports,h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mask"},[e("div",{staticClass:"form"},[e("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"https://www.chengzier.cn:8000/api/chapter_video",limit:1,name:"video","auto-upload":!1,headers:t.headers,data:t.video_data,"on-success":t.res,"on-change":t.change}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("选择视频")])],1),e("el-form",{attrs:{"label-position":t.labelPosition,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"名称"}},[e("el-input",{model:{value:t.video_data.name,callback:function(e){t.$set(t.video_data,"name",e)},expression:"video_data.name"}})],1),e("el-form-item",{attrs:{label:"章节id"}},[e("el-input",{model:{value:t.video_data.chapter_id,callback:function(e){t.$set(t.video_data,"chapter_id",e)},expression:"video_data.chapter_id"}})],1),e("el-form-item",{attrs:{label:"是否收费"}},[e("el-input",{model:{value:t.video_data.permission,callback:function(e){t.$set(t.video_data,"permission",e)},expression:"video_data.permission"}})],1)],1),e("div",{staticClass:"btn"},[e("el-button",{on:{click:t.upload}},[t._v("添加")]),e("el-button",{on:{click:t.cancle}},[t._v("取消")])],1)],1)])},p=[],_=a(31109);function v(t){return(0,_.Z)({url:`chapter_video?pk=${t}`,data:{pk:t},headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function f(t){return(0,_.Z)({url:"chapter_video",method:"DELETE",data:{pk:t},headers:{"Content-Type":"application/x-www-form-urlencoded"}})}var m={data(){return{labelPosition:"left",headers:{Authorization:""},video_data:{name:"",chapter_id:"",permission:""}}},props:["chapter_id"],created(){this.video_data.chapter_id=this.chapter_id},methods:{upload(){this.headers["Authorization"]="Bearer "+this.$store.state.token,this.$refs.upload.submit()},res(t){this.$emit("upload")},change(t,e){},cancle(){this.$emit("add_video")}}},b=m,w=(0,c.Z)(b,h,p,!1,null,null,null),k=w.exports,y=a(87343),g=a(76548),x={components:{Bullet:u,Add:k},data(){return{cont_state:!1,add_state:!1,subject:[],chapter:[],value_subject:"",value_chapter:"",video:[],video_src:[],chapter_id:""}},async created(){if(this.$store.state.subject.state||this.$store.state.chapter.state)this.subject=this.$store.state.subject.list,this.chapter=this.$store.state.chapter.chapter_list;else try{const t=await(0,y.kB)();this.subject=t.data.data;const e=await(0,g.bR)(this.subject[0].id);this.chapter=e.data.data}catch(t){console.log(t)}this.value_subject=this.subject[0].name,this.value_chapter=this.chapter[0].name,this.chapter_id=this.chapter[0].id,this.get_video()},methods:{async add_video(){this.add_state=!this.add_state},upload(){this.add_video(),this.get_video(this.chapter_id)},async get_video(t=this.chapter[0].id){if(this.video_src=[],0!=this.chapter.length){this.cont_state=!1;const e=await v(t);this.video=e.data.data,this.video.forEach((t=>{let e=t.mp4_url.split(".mp4");this.video_src.push(`https://www.chengzier.cn:9000/api/videoplay?path=${e[0]}`)}))}else this.cont_state=!0},async change(t){let e=this.subject.filter((e=>{if(e.name==t)return!0}));const a=await(0,g.bR)(e[0].id);this.chapter=a.data.data,this.chapter_id=this.chapter[0].id,this.value_chapter=this.chapter[0].name,this.get_video(this.chapter[0].id)},async change_chapter(t){let e=this.chapter.filter((e=>{if(e.name==t)return!0}));this.chapter_id=e[0].id,this.get_video(e[0].id)},async delete_video(t){await f(this.video[t].id),this.get_video(this.chapter_id)},async upload_video(t){this.delete_video(t),this.add_video(this.chapter_id)}}},j=x,C=(0,c.Z)(j,i,n,!1,null,"3ffc08d0",null),Z=C.exports},76548:function(t,e,a){a.d(e,{T6:function(){return o},ZA:function(){return r},bR:function(){return n},lJ:function(){return s}});var i=a(31109);function n(t){return(0,i.Z)({url:`chapter?pk=${t}`})}function s(t,e){return(0,i.Z)({url:"chapter",method:"PUT",data:{pk:t,chapter_name:e},headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function r(t,e){let a=new FormData;return a.append("pk",t),a.append("chapter_name",e),(0,i.Z)({url:"chapter",method:"POST",data:a})}function o(t){return(0,i.Z)({url:"chapter",method:"DELETE",data:{pk:t},headers:{"Content-Type":"application/x-www-form-urlencoded"}})}},87343:function(t,e,a){a.d(e,{Zd:function(){return o},gc:function(){return r},kB:function(){return n},oG:function(){return s}});var i=a(31109);a(95410);function n(){return(0,i.Z)({url:"classify"})}function s(t){const e=new FormData;return e.append("name",t),(0,i.Z)({url:"classify",method:"POST",data:e})}function r(t){return(0,i.Z)({url:"classify",method:"DELETE",data:{pk:t},headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function o(t,e){return(0,i.Z)({url:"classify",method:"PUT",data:{pk:t,name:e},headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]);
//# sourceMappingURL=465.bdb0f34a.js.map